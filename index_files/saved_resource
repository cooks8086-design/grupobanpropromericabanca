/**
 * @file integrate-es6.js
 * @description This file is responsible for loading the Spinviewer module & styles.
 * It attempts to load the ES module first, and if that fails, it falls back to the IIFE format.
 * ES module is preferred as it supports code splitting. 
 * This code was split from integrate-base.js in order to exempt it from the call to uglifyJS, which doesn't support ES6.
 * This file is prepended to integrate-base.js by the static deployment script.
 * @see integrate-base.js
 * @see ../deploy.py
 */

var ImpelSpinviewer;
var impel_spinviewer_loaded = false;

var add_spinviewer_module_helper = async function() {
    try {
        await add_spinviewer_module('es');
    } catch (e) {
        console.error(e);
        try {
            await add_spinviewer_module('iife');
        } catch (e) {
            console.error(e);
        }
    }
}

var add_spinviewer_module = async function(format) {
    const spinviewerURLPrefix = 'https:' + STS.STATIC_PREFIX + 'releases/spinviewer/spinviewer%40LATEST/' + format + '/';
    const cachebust = Date.now();

    if (format === 'es') {
        const { default: ImpelSpinviewerModule } = await import(spinviewerURLPrefix + 'impel-spinviewer.js?_=' + cachebust);
        ImpelSpinviewer = ImpelSpinviewerModule;

        if (ImpelSpinviewer.render) {
            impel_spinviewer_loaded = true;
        } else {
            throw new Error('Failed to load ES Spinviewer module.');
        }
    } else {
        var spinviewerESModule = document.createElement('script');
        spinviewerESModule.src = spinviewerURLPrefix + 'impel-spinviewer.js';

        document.head.append(spinviewerESModule);

        spinviewerESModule.onload = function () {
            impel_spinviewer_loaded = true;
        };
        spinviewerESModule.onerror = function () {
            throw new Error('CRITICAL: Failed to load IIFE Spinviewer module.');
        };
    }

    const spinviewerCSS = document.createElement('link');
    spinviewerCSS.href = spinviewerURLPrefix + 'impel-spinviewer-style.css';
    spinviewerCSS.type = 'text/css';
    spinviewerCSS.rel = 'stylesheet';

    spinviewerCSS.onerror = function () {
        throw new Error('CRITICAL: Failed to load Spinviewer styles.');
    };

    document.head.append(spinviewerCSS);
}
"use strict";var sts_tracking_only,STS=STS||{};STS.tracking_only=sts_tracking_only||!1,function(e,t,i,a,n,r,o,s,c,l,d,u){d.load_start=1*new Date,d.static_env=d.static_env||"prod",d.integrate_js_date="2025-10-16T22:37:38.472378",d.integrate_js_deployed_by="eJzLyi9OdchKy00py83MLUjNAQA3KgaN",d.integrate_js_commit="eec19073c9",d.colormap={"--key--":["natural","hover","WA btn"],default:["#00A19B","#F5A623","#00A19B"],black:["#000000","#000000","#000000"],blue:["#2D4F97","#4C8CCB","#4C8CCB"],bmwgray:["#808284","#404142","#808284"],cityauto:["#013785","#6D8EBC","#6D8EBC"],davesmithmotors:["#EC078D","#B0126F","#EC078D"],gold:["#FFDB59","#FFE68C","#FFDE66"],green:["#487700","#76C400","#497600"],green2:["#C1D83F","#616C20","#C1D83F"],haselwood:["#F4BC15","#FFE68C","#F4BC15"],heartlandtoyota:["#D72027","#F5878F","#D72027"],lexusofsilverspring:["#760108","#F20216","#F20216"],lightblue:["#428BCA","#214665","#428BCA"],nelsonmazda:["#1E88E5","#074472","#1E88E5"],nelsonmazdanogradient:["#1E88E5","#074472","#1E88E5"],pga:["#C10F13","#D91F23","#D91F23"],silver:["#A1A1A1","#CDCDCD","#C4C4C4"],subarublue:["#40609F","#203050","#40609F"],red:["#F52433","#F5878F","#F52433"],rochesteraudi:["#CC0033","#E80016","#CC0033"],westhillscjd:["#009BCA","#4C8CCB","#009BCA"],westhillshonda:["#1F64AF","#4C8CCB","#1F64AF"],westhillskia:["#C4172B","#F5878F","#C4172B"],westlake:["#369FF4","#2D85CC","#369FF4"]},d.loaded_versions=d.loaded_versions||{},d.loaded_versions[d.integrate_js_date]||(d.loaded_versions[d.integrate_js_date]=!0,d.popout_handlers=[],d.popin_handlers=[],function(e,t,i){t=new u,t.onload=function(){try{i={exports:{}},new Function("module","define",t.responseText)(i,void 0),d.jQuery=d.$=i.exports,e()}finally{t=null}},t.onerror=t.onabort=function(){t=null},t.open("GET","https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"),t.send()}(function(){function a(){return d.args.vinifierbaseurl?d.args.vinifierbaseurl:d.args.testvinifier?"https://"+d.args.testvinifier+"-vinifier.testenv.impel.io/":d.args.devvinifier?"string"==typeof d.args.devvinifier?"http://192.168.0."+d.args.devvinifier+":7774/":"http://localhost:7774/":"https://api"+(d.region&&"us"!==d.region?"-"+d.region:"")+".impel.io/"}function p(e,t){var i=e.href.slice(e.href.indexOf("#"))||e.hash;return i=i.split("&")[0],t=t||{},U.each(i.split(/[#!]|%23/),function(e,i){if(i){var a,n,r;a=i.split("="),n=o(a[0]).toLowerCase().replace(/[\-_]/g,""),r=a.length<2||o(a[1]),t[n]=r}}),t}function _(){$=1*new Date}function f(e){return n.round(100*n.random())<e?"a":"b"}function h(){var e=t.cookie.split("; "),i=e.find(function(e){return e.startsWith("experiment=")});if(i)return JSON.parse(i.split("=")[1])}function g(){return Q+(d.tracking_only?"v2":"integrate")+".js"}function v(t){function i(e,t){return t?"!"+e+"="+r(t):""}return t+=i("ga4measurementid",d.ga4_measurement_id),t+=i("gaclientid",d.ga_client_id),d.ga4_session_id&&(t+=i("ga4sessionid",d.ga4_session_id)),e&&e.document&&(t+=i("ga4pagereferrer",e.document.referrer),t+=i("ga4pagetitle",e.document.title),e.document.location&&(t+=i("ga4pagelocation",e.document.location.href))),t}function m(){function i(e){var i=t.getElementById("spincar-f-i-quiz");i&&(e.matches&&"(max-width: 1100px)"===e.media&&(i.style.maxHeight="100%",i.style.maxWidth="100%"),e.matches&&"(min-width: 1100px)"===e.media&&(i.style.maxHeight="700px",i.style.maxWidth="1000px"))}var n=t.createElement("div");n.id="spincar-f-i-quiz-wrapper",n.style.position="fixed",n.style.zIndex="99999999999",n.style.top="0",n.style.width="100vw",n.style.height="100vh",n.style.backgroundColor="rgba(0,0,0,0.7)",n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.addEventListener("click",function(){n.parentNode.removeChild(n)});var r=t.createElement("iframe");r.id="spincar-f-i-quiz";var o="https://spincar-static.s3.amazonaws.com/quiz/dist/index.html#";d.args.teststatic&&(o="https://sts-static-testenv.s3.amazonaws.com/static-test/"+d.args.teststatic+"/quiz/dist/index.html#");var s=o+"!canonical_hostname="+d.canonical_hostname+"!static_prefix="+Q+"!static_env="+d.static_env+"!vinifierbaseurl="+a();d.args.devanalytics?s+="!devanalytics="+d.args.devanalytics:d.args.testanalytics&&(s+="!testanalytics="+d.args.testanalytics),s=v(s),r.src=s,r.style.height="100%",r.style.width="100%",r.style.border="none",e.screen.width>1100&&(r.style.maxHeight="700px",r.style.maxWidth="1000px"),n.appendChild(r);var c=e.matchMedia("(max-width: 1100px)"),l=e.matchMedia("(min-width: 1100px)");return c.addListener(i),l.addListener(i),n}function y(e){function i(e,i){t.querySelector(e).contentWindow.postMessage(i,"*")}function a(e){try{i(".spin-frame",e)}catch(t){i('iframe[src*=".impel.io"]',e)}}function n(e){i("#spincar-f-i-quiz",e)}var r=e.data;if("string"==typeof r)if("STS:fi-from-spin::existence_check"===r)U(function(){a("STS:fi-to-spin::exists")});else if("STS:fi-from-spin::open"===r)t.body.style.overflow="hidden",t.body.appendChild(m());else if("STS:fi::close"===r){var o=t.body.querySelector("#spincar-f-i-quiz-wrapper");o.parentNode.removeChild(o),t.body.style.overflow=""}else r.startsWith("STS:fi-from-spin::setCustomerAndVin")?(r=r.split(":::")[1].split("/"),ue=r[0],pe=r[1]):"STS:fi-from-quiz::getCustomerAndVin"===r?n("STS:fi-to-quiz::returnCustomerAndVin:::"+ue+"/"+pe):"STS:GAData:request"===r?a(r):r.startsWith("STS:GAData:response")&&n(r)}function w(e,t){if(!impel_spinviewer_loaded)return void s(w,n.max(5,(1*new Date-$)/10));ImpelSpinviewer.render({container:e,mobile:d.browser.mobile,vinifierResponse:d.static_data.vinifier_response[t],analytics:{googleAnalytics4:{ga4MeasurementID:d.ga4_measurement_id},adobeAnalytics:{},tealium:d.tealium_tag_name,impelLegacy:{},impelDatalake:{}},uiOptions:{hidecarousel:!1,colors:d.get_colors(),disableautospin:d.args.disableautospin,hidecarfax:d.args.hidecarfax,widescreen:!1,hideviewtoggle:d.args.UI.hideviewtoggle,hidepowerbyimpel:d.args.UI.hidepowerbyimpel},pageType:d.page_type})}function b(e){if(!ce)return void s(b,n.max(5,(1*new Date-$)/10));var t=d.static_data.vinifier_response[e],i={container:"preview-fh-container",vinifierResponse:t,pageType:d.page_type};ImpelFeatureHighlights.render(i)}function k(){return!!t.cookie.match(new RegExp("(^| )SCOptout=([^;]+)"))}function x(e){return!!e.split("&")[0].split(/[#!]|%23/).includes("impelOptout")}function A(){return!!k()||(!!x(e.location.hash)||(!!i.globalPrivacyControl||!(!d.internal_tracking_optout&&!d.settings_optout)))}function S(){function t(t,i,a){var n=e.location.pathname,r=U('.vdp-component__container a:contains("CarHop")').contents().last().text();if(r=r&&r.split(",")[0],-1!==n.indexOf(t)||r===a)return!0;for(var o=0;o<i.length;o++)if(i[o]===n)return!0;return!1}return t("wa-98002",["/carhop-auto-sales-of-auburn/","/auburn-area-inventory/"],"Auburn")?76234:t("co-80012",["/carhop-auto-sales-of-aurora/","/aurora-area-inventory/"],"Aurora")?76221:t("mn-55434",["/carhop-auto-sales-of-blaine/","/blaine-mn-area-inventory/"],"Blaine")?80910:t("id-83704",["/carhop-auto-sales-of-boise/","/boise-area-inventory/"],"Boise")?103363:t("wa-98312",["/carhop-auto-sales-of-bremerton/","/bremerton-area-inventory/"],"Bremerton")?76235:t("mn-55337",["/carhop-auto-sales-of-burnsville/","/burnsville-area-inventory/"],"Burnsville")?79973:t("wi-54729",["/carhop-auto-sales-of-chippewa-falls/","/eau-claire-area-inventory/"],"Chippewa Falls")?80032:t("co-80905",["/carhop-auto-sales-of-colorado-springs/","/co-springs-area-inventory/"],"Colorado Springs")?103362:t("ia-51501",["/carhop-auto-sales-of-council-bluffs/","/council-bluffs-area-inventory/"],"Council Bluffs")?76225:t("mn-55429",["/carhop-auto-sales-of-crystal/","/crystal-mn-area-inventory/"],"Crystal")?80047:t("mn-55811",["/carhop-auto-sales-of-duluth/","/duluth-area-inventory/"],"Duluth")?79974:t("wa-98208",["/carhop-auto-sales-of-everett/","/everett-area-inventory/"],"Everett")?76236:t("mo-64116",["/carhop-auto-sales-of-kansas-city/","/kansas-city-area-inventory/"],"Kansas City")?103361:t("co-80214",["/carhop-auto-sales-of-denver-colfax/","/lakewood-area-inventory/"],"Lakewood")?76223:t("ne-68508",["/carhop-auto-sales-of-lincoln/","/lincoln-area-inventory/"],"Lincoln")?76219:t("mn-55117",["/carhop-auto-sales-of-maplewood/","/maplewood-mn-area-inventory/"],"Maplewood")?79972:t("az-85201",["/carhop-auto-sales-of-mesa/","/mesa-area-inventory/"],"Mesa")?103360:t("ca-91950",["/carhop-auto-sales-of-san-diego/","/san-diego-area-inventory/"],"National City")?103356:t("ne-68104",["/carhop-auto-sales-of-omaha/","/omaha-metro-area-inventory/"],"Omaha")?76232:t("ca-95841",["/carhop-auto-sales-of-sacramento/","/sacramento-area-inventory/"],"Sacramento")?103359:t("wa-98103",["/carhop-auto-sales-of-seattle/","/seattle-area-inventory/"],"Seattle")?76239:t("sd-57105",["/carhop-auto-sales-of-sioux-falls/","/sioux-falls-area-inventory/"],"Sioux Falls")?76233:t("mn-56301",["/carhop-auto-sales-of-st-cloud/","/saint-cloud-area-inventory/"],"St. Cloud")?80031:t("mo-64506",["/carhop-auto-sales-of-st-joseph/","/st-joseph-area-inventory/"],"St. Joseph")?76226:t("wa-98499",["/carhop-auto-sales-of-tacoma/","/tacoma-area-inventory/"],"Tacoma")?76237:t("ok-74112",["/carhop-auto-sales-of-tulsa/","/tulsa-area-inventory/"],"Tulsa")?103357:t("ca-94590",["/carhop-auto-sales-of-vallejo/","/vallejo-area-inventory/"],"Vallejo")?103358:null}function C(){function t(t,i){var a=e.location.pathname.split("/")[2],n=U(".unit-location-text").text();return a&&a.includes(t[0])||n.includes(t[1])||n.includes(i)}return t(["alabama","Alabama"],"AL")?110689:function(t,i){var a=new URLSearchParams(e.location.search),n=a.get("lots"),r=U(".unit-location-text").text();return n&&n.includes(t)||r.includes(i)}("1550","Alvarado")?95583:t(["arkansas","Arkansas"],"AR")?110690:t(["arizona","Arizona"],"AZ")?110691:t(["california","California"],"CA")?110692:t(["colorado","Colorado"],"CO")?110693:t(["connecticut","Connecticut"],"CT")?110694:t(["florida","Florida"],"FL")?110695:t(["georgia","Georgia"],"GA")?110696:t(["idaho","Idaho"],"ID")?110716:t(["indiana","Indiana"],"IN")?110717:t(["iowa","Iowa"],"IA")?110697:t(["kansas","Kansas"],"KS")?110698:t(["kentucky","Kentucky"],"KY")?110699:t(["michigan","Michigan"],"MI")?110700:t(["missouri","Missouri"],"MO")?110701:t(["montana","Montana"],"MT")?110702:t(["nevada","Nevada"],"NV")?110703:t(["new-hampshire","New Hampshire"],"NH")?110704:t(["new-mexico","New Mexico"],"NM")?110705:t(["new-york","New York"],"NY")?110706:t(["north-carolina","North Carolina"],"NC")?110718:t(["ohio","Ohio"],"OH")?110707:t(["oklahoma","Oklahoma"],"OK")?110708:t(["oregon","Oregon"],"OR")?110741:t(["pennsylvania","Pennsylvania"],"PA")?110719:t(["south-carolina","South Carolina"],"SC")?110709:t(["tennessee","Tennessee"],"TN")?110710:t(["texas","Texas"],"TX")?110711:t(["utah","Utah"],"UT")?110712:t(["vermont","Vermont"],"VT")?110713:t(["virginia","Virginia"],"VA")?110714:t(["washington","Washington"],"WA")?110715:t(["wyoming","Wyoming"],"WY")?110688:null}function O(){var t=e.location.pathname.split("/")[2];return"carite-of-chesterfield"===t?62337:"carite-of-eastpointe"===t?61662:"carite-of-fort-pierce"===t?59540:"carite-of-garden-city"===t?62303:"carite-of-grand-ledge"===t?66195:"carite-of-hartland"===t?65073:"carite-of-indianapolis"===t?62614:"carite-of-kalamazoo"===t?66834:"carite-of-madison-heights"===t?63257:"carite-of-memphis"===t?63255:"carite-of-taylor"===t?62304:"carite-of-windsor-locks"===t?72097:null}function E(){var t=e.location.href.match(/\/(buy-here-pay-here.*)\//);if(t){var i=t[1];if(-1!==i.indexOf("-il122"))return 46897;if(-1!==i.indexOf("-inc02"))return 65363;if(-1!==i.indexOf("-inc03"))return 65364;if(-1!==i.indexOf("-inc07"))return 65365;if(-1!==i.indexOf("-in115"))return 65366;if(-1!==i.indexOf("-kyc20"))return 65360;if(-1!==i.indexOf("-ky107"))return 47315;if(-1!==i.indexOf("-ny107"))return 47415;if(-1!==i.indexOf("-oh112"))return 65361;if(-1!==i.indexOf("-oh154"))return 65325;if(-1!==i.indexOf("-pa114"))return 65362;if(-1!==i.indexOf("-tx126"))return 52992;if(-1!==i.indexOf("-ut104"))return 47187;if(-1!==i.indexOf("-ut105"))return 47140;if(-1!==i.indexOf("-va102"))return 47476;if(-1!==i.indexOf("-wv104"))return 47317;if(-1!==i.indexOf("-wv105"))return 47318;if(-1!==i.indexOf("-wv106"))return 42105;if(-1!==i.indexOf("-wv107"))return 42104;if(-1!==i.indexOf("-wv109"))return 47316}return null}function T(){var t=e.location.pathname.split("/")[1];return"coolsprings"===t?54414:"murfreesboro"===t?55710:null}function I(){function t(t){var i=e.location.href,a=[t.toLowerCase().replace(/ /g,""),t.toLowerCase().replace(/ /g,"-"),t.toLowerCase().replace(/ /g,"%20")];if(-1!==U(".LiInvlocation .unitValue").first().text().indexOf(t))return!0;for(var n=0;n<a.length;n++)if(-1!==i.indexOf(a[n]))return!0;return!1}return t("Fox River")?104103:t("Illinois")?104102:t("Triumph Detroit")?103974:t("Windy City International")?103973:t("Woodstock KTM")?103975:null}function j(){var t=e.location.pathname.split("/")[1];return"logan-inventory"===t||"Logan"===U.trim(U(".unit-location-text").text())?109360:"helper-inventory"===t||"Helper"===U.trim(U(".unit-location-text").text())?109361:null}function L(){function t(e){return U("div.LotLocation, .operating-hours h4").text().toLowerCase().includes(e)}return t("berlin")?111795:t("milford")||"/"===e.location.pathname?111796:t("boyertown")?111797:null}function P(){function t(t){return"https://www.hendycarstore.co.uk"===e.location.origin&&new URLSearchParams(e.location.search).get("filters[Location][Retailers][0]")===t}return U('a:contains("Car Store Portsmouth Car Store")').first().text().trim().includes("Portsmouth")?119138:t("54021")?119138:U('div.hidden:contains("Hendy Group Carstore") > .justify-end').text().trim().includes("Hendy Group")||"/"===e.location.pathname?119137:t("54017")?119137:null}function F(){var t=e.location.href,i=null;return i="/"===e.location.pathname||t.includes("644006c50e15dc993a6034a8")?119693:119694,t.includes("644006c50e15dc993a6034a8")&&t.includes("646dd788d949a7fe54131b58")&&(i=119694),"vdp"===d.page_type&&(U("a:contains('Castle Donington')").length?i=119693:U("a:contains('Sutton In Ashfield')").length&&(i=119694)),i}function D(e){return e.replace(/[a-zA-Z]/g,function(e){return String.fromCharCode((e<="Z"?90:122)>=(e=e.charCodeAt(0)+13)?e:e-26)})}function N(e,t){function i(){const t=this.responseText,i=t.match(/STS\.chatbot_enabled\s*=\s*(true|false)\s*;/);if(i){const a="true"===i[1];e(a)}else c.warn("chatbot_enabled not found in script"),e(!1)}const a="test"===t?"https://chat-cdn-test.impel.ai/integrate/":"https://chat-cdn.impel.ai/integrate/",n=a+Z+".js",r=new u;r.addEventListener("load",i),r.addEventListener("error",function(){c.warn("XHR failed to load chatbot config script"),e(!1)}),r.open("GET",n),r.send()}function z(t,i){function a(){try{const i=this.responseText,a=e.location.hostname.replace(/^www\./,"").toLowerCase(),n=new RegExp("['\"]"+a+"['\"]"),r=n.test(i);t(r)}catch(e){c.warn("Failed to check pilot dealer domain:",e),t(!1)}}const n="test"===i?"https://chat-cdn-test.impel.ai/integrate/":"https://chat-cdn.impel.ai/integrate/",r=n+"chat_s3_domains_list.js",o=new u;o.addEventListener("load",a),o.addEventListener("error",function(){c.warn("XHR failed to load chat_s3_domains_list.js"),t(!1)}),o.open("GET",r),o.send()}function q(){d.analytics2.spin=!0,d.analytics2.spin_latency=1*new Date-d.load_start,d.Analytics2.SendNow()}function W(){q(),d.injection_done=!0;var t=d.spin.firstChild.src;t.indexOf("!showplaceholder")>0&&(t=d.spin_url=d.spin.firstChild.src.replace("!showplaceholder",""),d.spin.firstChild.src=t),d.spin.style.display="block",fe(d.spin),s(function(){U(e).triggerHandler("resize")},0),ve(d.spin.firstChild);var a=U("<a>").attr("href","http://impel.io").html("360 WalkAround Powered By SpinCar").css("font-family","sans").css("font-size","8px").css("position","absolute").css("bottom",0).css("right",0).appendTo(d.spin),n=(i.userAgent||"").toLowerCase();-1===n.indexOf("googlebot")&&-1===n.indexOf("bingbot")&&a.hide()}function M(i,a,r,o){if(a=U.trim(a).toLowerCase()){if(d.page_type="vdp",c.log("spincar_detected_vin =",a),d.debug=!1,!0===d.args.debugspin)i="swipetospin",a="tesla",d.debug=!0,d.partner=void 0;else if(d.args.debugspin){var l=U.grep(d.args.debugspin.split("/"),function(e){return e});i=l[0],a=l[1],d.debug=!0,d.partner=void 0}else"string"==typeof d.args.debugvin&&(a=d.args.debugvin,d.debug=!0);d.customer=d.analytics2.s3_folder=d.args.stscustomer||i,d.args.stsregion?d.region=d.args.stsregion:d.regioner(d.customer),d.vin=d.analytics2.vin=a,d.Analytics2.SendNow(),d.injection_done=!1,void 0!==d.args.popoutenabled&&(d.popout_enabled=d.args.popoutenabled),_(),function l(){function u(){if(!(Object.keys(d.static_data.vinifier_response).length>0&&impel_spinviewer_loaded&&oe))return void s(u,n.max(5,(1*new Date-$)/10));var e=d.static_data.vinifier_response[d.vin];if(e.spin_placeholder){var t=d.vehicle_data.spin_placeholder.still.full_res,i=d.vehicle_data.spin_placeholder.fallback.full_res;d.browser.mobile&&(t=d.vehicle_data.spin_placeholder.still.low_res,i=d.vehicle_data.spin_placeholder.fallback.low_res),""!==t?r(v,W,t):r(v,W,i)}else r(v,W);d.spin_exists=!0;var a={container:d.spin.id,mobile:d.browser.mobile,language:"en",analytics:{googleAnalytics4:{ga4MeasurementID:d.ga4_measurement_id},adobeAnalytics:{},tealium:d.tealium_tag_name,impelLegacy:{},impelDatalake:{}},uiOptions:{hidecarousel:!1,colors:d.get_colors(),disableautospin:d.args.disableautospin,hidecarfax:d.args.hidecarfax,widescreen:d.iframeless_widescreen_enabled,forcelowres:d.args.forcelowres,hideviewtoggle:d.args.UI.hideviewtoggle,hidepowerbyimpel:d.args.UI.hidepowerbyimpel},vinifierResponse:e,pageType:d.page_type};ImpelSpinviewer.render(a)}function p(){if(!(Object.keys(d.static_data.vinifier_response).length>0&&ce&&oe))return void s(p,n.max(5,(1*new Date-$)/10));var t=d.static_data.vinifier_response[d.vin];o(k,function(){k.style.display="block",d.initFeatureHighlightsFullBrowser(),e.removeEventListener("message",S)}),d.feature_highlights_exists=!0;var i={container:"spincar-feature-highlights",vinifierResponse:t};ImpelFeatureHighlights.render(i)}if(!d.region)return void s(l,n.max(5,(1*new Date-$)/10));if(d.iframeless_enabled){var f={requestParams:{customer:d.customer,partner:d.partner,region:d.region,vin:d.vin},onRequestSuccess:function(e){d.static_data.sts_spin_exists=!0,H({originalEvent:{data:"sts_vehicle_data:"+JSON.stringify(e)}})},onRequestError:function(e,t){c.error(e),c.error(t)}};d.vinifier(f.requestParams,f.onRequestSuccess,f.onRequestError)}var h=d.spin_url=d.get_spin_url(a,i),g=" !important",v=t.createElement("div"),m="sts_"+n.random().toString().split(".")[1];v.id=m,U(v).addClass("sts-spin"),v.style.display="none",v.style.width="100%",v.style.position="relative",v.style.zIndex="0",U(v).data("aspect",16/9),U(v).addClass("sts-spin");var y=d.iframeless_enabled?"div":"iframe",w=t.createElement(y);w.name=m,w.src=h,w.scrolling="no",w.allowFullscreen="true",U(w).attr("style",["border:none"+g,"margin:0"+g,"padding:0"+g,"width:1px"+g,"height:1px"+g,"min-width:100%"+g,"min-height:100%"+g,"z-index:0"+g].join(";")),w.id=m+"-iframe",w.classList.add("spin-frame"),w.title="Interactive Walkaround/Photo gallery of the vehicle/product",d.tracking_only?(w=void 0,v=!1):(U(v).prepend(w),U("body").prepend(v)),d.spin=v,U(e).on("message.sts_vehicle_data",H);var b=function(t){if(t=t.originalEvent,"sts_no_spin_exists"===t.data&&(U(e).off("message.sts_spin_exists"),d.spin_exists=!1,d.analytics2.spin=!1,d.Analytics2.SendNow(),d.addWidgetToImpelAna()),"sts_spin_exists"===t.data){if("function"!=typeof r)return;if(U(e).off("message.sts_spin_exists"),d.spin_exists=!0,d.addWidgetToImpelAna(),d.tracking_only)return void q();if(ee&&"b"===te.group)return;if(d.vehicle_data.spin_placeholder){var i=d.vehicle_data.spin_placeholder.still.full_res,a=d.vehicle_data.spin_placeholder.fallback.full_res;d.browser.mobile&&(i=d.vehicle_data.spin_placeholder.still.low_res,a=d.vehicle_data.spin_placeholder.fallback.low_res),""!==i?r(v,W,i):r(v,W,a)}else r(v,W)}};if(U(e).on("message.sts_spin_exists",b),d.iframeless_enabled&&(_(),u()),d.feature_highlights_enabled&&o){var k=t.createElement("div");k.style.display="none",k.style.width="100%",k.style.minWidth="250px",k.style.height="420px",k.style.position="relative";var x=d.iframeless_enabled?"div":"iframe",A=t.createElement(x);A.id="spincar-feature-highlights",A.name="impel-feature-highlights",g=" !important",U(A).attr("style",["border:none"+g,"margin:0"+g,"padding:0"+g,"width:1px"+g,"height:1px"+g,"min-width:100%"+g,"min-height:100%"+g,"z-index:0"+g].join(";")),A.src=d.get_feature_highlights_url(a,i),A.scrolling="no",A.allowFullscreen="true",U(k).prepend(A),U("body").prepend(k);var S=function(t){"feature_highlights_exists"===t.data?o(k,function(){k.style.display="block",d.initFeatureHighlightsFullBrowser(),e.removeEventListener("message",S)}):"feature_highlights_no_existence"===t.data&&e.removeEventListener("message",S)};e.addEventListener("message",S)}d.iframeless_enabled&&(_(),p())}()}}function H(t){if(t=t.originalEvent,/^sts_vehicle_data:/.test(t.data)){"srp"===d.page_type&&(d.analytics2.s3_folder=d.customer),U(e).off("message.sts_vehicle_data");var i=d.vehicle_data=JSON.parse(/:(.*)$/.exec(t.data)[1]);U(e).triggerHandler("sts_vehicle_data",i),d.partner&&d.customer!==i.s3_folder&&(d.analytics2.s3_folder=i.s3_folder),!d.args.debugspin&&i.vin&&i.vin!==d.analytics2.vin?(d.analytics2.vin=i.vin,d.Analytics2.SendNow()):"srp"===d.page_type&&d.Analytics2.SendNow(),se&&d.chatbot_enabled&&ImpelChatbot.setVdpVehicleInfo(ye()),opener&&opener.postMessage(t.data,"*")}}function R(i){if("STS:integration-context"===i.data){var a=t.querySelector(".spin-frame");a&&a.contentWindow.postMessage("STS:integration-context"+JSON.stringify({url:e.location.href}),e.location.protocol+"//cdn.impel.io")}}function B(e){if("STS::web_buy_button_clicked"===e.data){var i=t.querySelector(".preview-spin-container");i&&(i.style.zIndex=999)}}var U,X;U=X=d.jQuery;var J=function(e){return U.parseJSON(e)},V=function(e){function t(e){switch(typeof e){case"number":case"boolean":return""+e;case"undefined":return"null";case"object":if(null===e)return"null";if(e.hasOwnProperty("length")){for(var n=[],r=0;r<e.length;++r)n.push(t(e[r]));return"["+n.join(",")+"]"}var n=[];for(var o in e)e.hasOwnProperty(o)&&void 0!==e[o]&&n.push(t(o)+":"+t(e[o]));return"{"+n.join(",")+"}";case"string":return'"'+(i.test(e)?e.replace(i,function(e){var t=a[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}):e)+'"';default:return t(""+e)}}var i=/[\\\"\u0000-\u001f\u007f-\uffff]/g,a={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return V=t,t(e)},G=function(e){var t,i,a,n,r,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="",c="",l="",d=0;do{t=e.charCodeAt(d++),i=e.charCodeAt(d++),c=e.charCodeAt(d++),a=t>>2,n=(3&t)<<4|i>>4,r=(15&i)<<2|c>>6,l=63&c,isNaN(i)?r=l=64:isNaN(c)&&(l=64),s=s+o.charAt(a)+o.charAt(n)+o.charAt(r)+o.charAt(l),t=i=c="",a=n=r=l=""}while(d<e.length);return s};d.browser=d.browser||{},d.browser.IE=function(){return e.document.documentMode||0}(),d.browser=d.browser||{},d.browser.ios=function(){return!!/iPad|iPhone|iPod/.test(i.userAgent)||i.maxTouchPoints&&i.maxTouchPoints>2&&/Apple/.test(i.vendor)}(),d.browser.mobile=function(e){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}(i.userAgent||i.vendor||e.opera),function(){var e=function(e,t,i,a,n){n=n||{},t.max_age=t.max_age||1/0;var r="",o="",s="",l=e.split("/"),p=-1!==e.indexOf("regioner"),_=-1!==e.indexOf("spin");if(p)s=d.args.testregioner?"//cdn.testenv.impel.io/static-test/"+d.args.testregioner:"//cdn.impel.io/spincar-static",o=l[l.length-1],r=[s,"fallback","regioner",o].join("/")+".json";else{if(!_)return void c.error("Unsupported URL::read_cache::url:",e);s=d.args.testvinifier?"//cdn.testenv.impel.io/static-test/"+d.args.testvinifier:"//cdn.impel.io/spincar-static",o=l[l.length-2];r=[s,"fallback","vinifier",o,l[l.length-1].split("?")[0]].join("/")+".json"}var f=new u;f.open("GET",r,!0),f.onreadystatechange=function(){4===f.readyState&&(200===f.status?i(f.status,f.responseText):a())},f.onerror=function(){c.error("Network error::read_cache::url:",e)},f.send()};d.read_cached_url=function(t,i,a){var n,r=i.success,o=i.error,c=!1,l=!1,u=!1,p=!1,_=function(e,t){c||(c=!0,e&&e(t))},f=function(){l=!0,u?_(o):n&&_(r,n)},h=function(){l?f():s(f,2500)};if(U.ajax({dataType:"json",url:t,success:function(e){p=!0,_(r,e)},error:function(){f()}}),!d.args.automatichotspots||!d.args.devvinifier){s(function(){p||a&&a.dev&&!a.dev_cache||e(t,i,function(e,t){e<200||299<e?u=!0:n=JSON.parse(t),h()},function(){u=!0,h()},a)},500)}}}(),function(){d.vinifier=function(e,t,i){"swipetospin"===e.customer&&"us"!==d.region&&(d.region="us");var n=a();e.partner?n+="any-spin/"+e.partner+"/"+e.vin:n+="spin/"+e.customer+"/"+e.vin,n+="?v=20160212",d.args.automatichotspots&&(n+="&automatichotspots="+d.args.automatichotspots),d.args.config&&(n+="&config="+d.args.config),d.args.showold&&(n+="&show_old=true"),d.manager_preview&&(n+="&managerpreview=1&_="+1*new Date),d.read_cached_url(n,{success:function(a){a.show_spin||!d.old_ui_enabled&&a.show_featuretour?(d.static_data.vinifier_response[e.vin]=a,t&&t(a)):i&&i(!1,a)},error:function(){i&&i(!0,{info:{options:{}},show_spin:!1})}},{dev:d.args.devvinifier,dev_cache:d.args.devvinifier&&d.args.devvinifiercache})}}(),function(){var t,i=["disableautospin","disabledrawer","disablescrolltozoom","econly","enablesmallcursor","hidecarousel","hideexpandbtn","hidefeaturetour","hidehotspots","hidedamagetags","hidedamage","hidepowerbyspincar","showpowerbyspincar","hidepowerbyimpel","hidezoom","showpowerbyimpel","hidelivevideo","lang","stscolor","specialfeaturecolor","useinnerwidth","hidecta","enterprisetheme","hideviewtoggle"];try{t=JSON.parse(sessionStorage.getItem("STS.args"))}catch(e){}var a=d.args=t||{testremoteenv:!1,teststatic:!1,testvinifier:!1,testanalytics:!1,devvinifier:!1,devanalytics:!1,debugspin:!1,testexperiment:!1};p(e.location,a),d.args.UI={};for(var n in d.args)i.indexOf(n)>-1&&("disabledrawer"===n&&!0===d.args[n]&&(d.args.UI.hidecarousel=!0),d.args.UI[n]=d.args[n],delete d.args[n]);if(a.testall&&U.each(["teststatic","testvinifier","testanalytics"],function(e,t){a[t]=a[t]||a.testall}),a.saveargs)try{sessionStorage.setItem("STS.args",JSON.stringify(a))}catch(e){}}();var Y,Q="//cdn.impel.io/",Z=d.canonical_hostname=e.location.hostname.toLowerCase().replace(/^(www\.)+/,"");if("pilot"===d.static_env)Y=!0;else if(d.args.teststatic&&!d.args.testaddpilot)Y=!1;else{var K={};Y=!d.args.suppresspilot&&Z in K}Y?Q+="static-test/pilot/":d.args.testremoteenv&&d.args.teststatic||d.args.teststatic?Q="//cdn.impel.io/static-test/"+d.args.teststatic+"/":Q+="spincar-static/";var $=1*new Date,ee=!1,te=h(),ie={experiment:"",expiration:"",expirationISO:"",domains:[]},ae=new Date(ie.expirationISO).getTime()>(new Date).getTime(),ne=-1!==ie.domains.indexOf(Z),re=!(d.args.teststatic&&!d.args.testexperiment),oe=!1,se=!1,ce=!1;if(ae&&ne&&re&&(ee=!0,te||(!function(e){var i=e.experiment,a=new Date(e.expiration).toUTCString(),n=JSON.stringify({id:i,group:f(50)});t.cookie="experiment="+n+"; expires="+a+"; path=/"}(ie),te=h())),d.STATIC_PREFIX=Q,U.get(Q+"settings.json",function(e){!e.optout||"1"!==e.optout&&1!==e.optout?d.settings_optout=!1:d.settings_optout=!0}).fail(function(e,t,i){c.error("Request failed",i)}),Y&&"pilot"!==d.static_env)return d.static_env="pilot",void U.getScript(g());if(!Y&&d.args.teststatic&&"test"!==d.static_env)return d.static_env="test",void U.getScript(g());if(!(d.args.nospin||d.browser.IE&&d.browser.IE<11)){d.args.UI.lang&&U("html").attr("lang",d.args.UI.lang),d.args.spp&&t.body.appendChild(function(){function i(e){e.matches&&"(max-width: 530px)"===e.media&&(n.style.height="100%",n.style.width="100%",n.style.margin="0",n.style.maxHeight="none",n.style.maxWidth="none",n.style.bottom="0",r.style.height="30px",o.innerHTML='<svg viewbox="-7 -7 30 30" xmlns="http://www.w3.org/2000/svg" width="30" height="30"><line x1="1" y1="15" x2="15" y2="1" stroke="black" stroke-width="2"/><line x1="1" y1="1" x2="15" y2="15" stroke="black" stroke-width="2"/></svg>',o.style.height="30px"),e.matches&&"(min-width: 530px)"===e.media&&(n.style.margin="50px",n.style.bottom="20px",n.style.height="80%",n.style.maxHeight="800px",n.style.maxWidth="1200px",r.style.height="40px",o.innerHTML='<svg viewbox="-12 -12 40 40" xmlns="http://www.w3.org/2000/svg" width="40" height="40"><line x1="1" y1="16" x2="16" y2="1" stroke="black" stroke-width="2"/><line x1="1" y1="1" x2="16" y2="16" stroke="black" stroke-width="2"/></svg>',o.style.height="40px")}var a=t.createElement("div");a.id="spincar-spp-modal-wrapper",a.style.position="fixed",a.style.zIndex="99999999999",a.style.top="0",a.style.width="100vw",a.style.height="100vh",a.style.backgroundColor="rgba(0,0,0,0.85)",a.style.display="flex",a.style.justifyContent="center",a.style.alignItems="center";var n=t.createElement("div");n.id="spp-iframe-wrapper",n.style.position="relative",n.style.height="100%",n.style.width="100%",n.style.border="none";var r=t.createElement("div");r.style.height="40px",r.style.backgroundColor="#ffffff",r.id="spp-close-btn-div";var o=t.createElement("div");o.innerHTML='<svg viewbox="-12 -12 40 40" xmlns="http://www.w3.org/2000/svg" width="40" height="40"><line x1="1" y1="16" x2="16" y2="1" stroke="black" stroke-width="2"/><line x1="1" y1="1" x2="16" y2="16" stroke="black" stroke-width="2"/></svg>',o.style.float="right",o.style.height="40px",o.style.cursor="pointer",o.id="spp-close-btn",r.appendChild(o);var s=t.createElement("iframe");s.id="spincar-spp-modal",s.src=d.args.spp,s.style.height="100%",s.style.width="100%",s.style.border="none",s.style.backgroundColor="#ffffff",e.innerWidth>530&&(n.style.height="80%",n.style.maxHeight="800px",n.style.maxWidth="1200px",n.style.margin="50px",n.style.bottom="20px",
o.innerHTML='<svg viewbox="-12 -12 40 40" xmlns="http://www.w3.org/2000/svg" width="40" height="40"><line x1="1" y1="16" x2="16" y2="1" stroke="black" stroke-width="2"/><line x1="1" y1="1" x2="16" y2="16" stroke="black" stroke-width="2"/></svg>',o.style.height="40px"),n.appendChild(r),n.appendChild(s),a.appendChild(n),a.addEventListener("click",function(e){"spincar-spp-modal-wrapper"===e.target.id&&a.parentNode.removeChild(a)}),o.addEventListener("click",function(){a.parentNode.removeChild(a)});var c=e.matchMedia("(max-width: 530px)"),l=e.matchMedia("(min-width: 530px)");return c.addListener(i),l.addListener(i),a}());var le=U('<link rel="stylesheet">').attr("href",Q+"20190909/i18n/walkaround.scss?_=eec19073c9f653"),de=U("head");0===d.canonical_hostname.indexOf("hgreg")&&(de=U("body")),de.append(le),/\.kjdev\.ca$/.test(d.canonical_hostname)&&(Z="kjdev.ca");var ue="",pe="";e.addEventListener("message",y),d.extra_spin_args={},d.popout_enabled=!0,d.criteo={},d.static_data={sts_spin_exists:!1,vinifier_response:{},analytics:{}},function(){var i;U(e).on("message",function(e){e=e.originalEvent,"sts_popout"===e.data&&i&&(i.remove(),i=null)}),d.preview_spin=function(a){function r(){U(t).off("keydown.popup"),i&&(i.remove(),i=null)}var o=d.get_spin_url(a)+"!popoutenabled=out",s="sts_"+n.random().toString().split(".")[1];i=U("<div>").css({position:"fixed",top:0,left:0,width:"100%",height:"100%","z-index":1e12,"background-color":"rgba(0,0,0,0.9)"}).addClass("preview-spin-container").attr("id",s);var c=U("<div>").css({position:"fixed",height:"100%",width:"100%"}).append(U("<iframe>").css({border:"none",height:"100%",width:"100%"}).attr("src",o).attr("allowfullscreen",!0).attr("name",s));if(i.append(c),d.iframeless_enabled)return i.find("iframe").remove(),U("body").append(i),U(t).on("keydown.popup",function(e){"Escape"!==e.key&&27!==e.keyCode||r()}),_(),void w(s,a);U("body").append(i),U(e).on("message",function(e){if("STS:FullBrowser::close"===e.originalEvent.data&&!d.old_ui_enabled){if(!i)return;i.remove(),i=null}})}}(),function(){var i;U(e).on("message",function(e){e=e.originalEvent,"sts_popout"===e.data&&i&&(i.remove(),i=null)}),d.preview_feature_highlights=function(a){function n(){U(t).off("keydown.popup"),i&&(i.remove(),i=null)}var r=d.get_feature_highlights_url(a)+"!seeall";i=U("<div>").css({position:"fixed",top:0,left:0,width:"100%",height:"100%","z-index":1e12}).addClass("preview-fh-container").attr("id","preview-fh-container");var o=U("<div>").css({position:"fixed",height:"100%",width:"100%"}).append(U("<iframe>").css({border:"none",height:"100%",width:"100%"}).attr("src",r).attr("allowfullscreen",!0));if(i.append(o),d.iframeless_enabled)return i.find("iframe").remove(),U("body").append(i),U(t).on("keydown.popup",function(e){"Escape"!==e.key&&27!==e.keyCode||(t.body.style.removeProperty("overflow"),n())}),_(),void b(a);U("body").append(i),U(e).on("message",function(e){if("STS:feature-highlights::close"===e.originalEvent.data){if(!i)return;i.remove(),i=null}})}}();var _e=function(){return[n.min(e.innerWidth||t.documentElement.clientWidth||t.body.clientWidth,e.outerWidth||1/0),n.min(e.innerHeight||t.documentElement.clientHeight||t.body.clientHeight,e.outerHeight||1/0)]};U(e).on("message.sts_update_aspect",function(e){if(e=e.originalEvent,"string"==typeof e.data&&"sts_update_aspect:"===e.data.substr(0,18)){var t=parseFloat(e.data.substr(18));U(".sts-spin").each(function(){if(U(this).find("iframe")[0].contentWindow===e.source){var i=U(this).data("aspect");return n.abs(i-t)/i>.005&&(U(this).data("aspect",t),U(this).triggerHandler("aspect-change")),!1}})}}),function(){function t(t,a,r){function o(){var e,i,a=t.data("aspect"),r=_e(),o=n.min(r[1],r[0]/a),s=n.ceil(o*a);e=(r[0]-s)/2,i=(r[1]-o)/2,t.css({left:e,top:i,width:s,height:o})}if(r=U.extend({},r,d.popout_options),r.hasOwnProperty("no_history")||(r.no_history=!1),void 0===a&&(a=function(){}),t.data("popped-out"))return void(i&&i());d.popout_handlers.forEach(function(e){e()}),t.data("popped-out",!0),U(".sts-spin-click-cover").hide();var c="offsetY"in r&&"height"in r?"->"+r.offsetY+","+r.height:"";t.find("iframe")[0].contentWindow.postMessage("sts_popping_out"+c,"*");var u=U("<div>");u.css({opacity:.8,"background-color":"black",position:"fixed",width:"200%",height:"200%",top:"0px",left:"0px","z-index":1e9,"-webkit-backface-visibility":"hidden"}),u.on("mousedown",function(e){e.preventDefault(),e.stopPropagation()}),t.before(u);var p=t.css("position"),_=t.css("z-index"),f=t.css("left"),h=t.css("top"),g=t[0].style.width,v=t[0].style.height,m=U(e).scrollLeft(),y=U(e).scrollTop(),w=U("<div>");w.addClass("sts-placeholder"),w.css({position:p,"z-index":_,left:f,top:h,width:g,height:v}),t.after(w),t.css({position:"fixed","z-index":1e9+1,"-webkit-backface-visibility":"hidden"}),o(),U(e).on("resize.popout",function(){o(),s(function(){d.recompute_size(),o()},100)}),t.on("aspect-change.popout",o);var b=!1,k=!1;i=function(){if(!k){i=void 0,k=!0,t.stop(!0),u.stop(!0),U(e).off("resize.popout"),t.off("aspect-change.popout"),U(e).off("popstate.popout"),u.off("click.popout");try{b&&l.back(),b=!1}catch(e){}try{U(e).scrollLeft(m),U(e).scrollTop(y)}catch(e){}t.data("popped-out",!1),U(".sts-spin-click-cover").show(),w.remove(),t.css({position:p,"z-index":_,left:f,top:h,width:g,height:v,"-webkit-backface-visibility":""}),u.remove(),d.popin_handlers.forEach(function(e){e()}),t.find("iframe")[0].contentWindow.postMessage("sts_popped_in","*"),a(),t.triggerHandler("aspect-change")}};try{if(r.no_history)throw 0;l.pushState("sts-popout","",e.location.href),b=!0}catch(e){}U(e).on("popstate.popout",function(){b=!1,i()});var x=setInterval(function(){try{if(r.no_history)throw 0;if("sts-popout"===l.state)return;if(void 0===l.state)throw 0;if(!i)throw 0;throw b=!1,i(),0}catch(e){clearInterval(x)}},50);u.on("click.popout",function(e){e.stopPropagation(),e.preventDefault(),i()})}var i;d.popout=t;var a=1*new Date;U(e).on("message.sts_popout",function(e){e=e.originalEvent,"sts_popout"===e.data&&(1*new Date-a<500||(a=1*new Date,U(".sts-spin").each(function(){if(U(this).find("iframe")[0].contentWindow===e.source)return t(U(this)),!1})))});try{"sts-popout"===l.state&&l.back()}catch(e){}}();var fe=function(t){d.extra_spin_args.use_inner_width&&(_e=function(){return[e.innerWidth,e.innerHeight]});var i=U(t);if(d.browser.mobile){var a=i.height();d.popin_handlers.push(function(){i.height(a)})}var r=U("<div>").addClass("sts-spin-click-cover").css({position:"absolute","z-index":-1,left:0,top:0,width:"100%",height:"100%",cursor:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAZCAYAAABggz2wAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAG2YAABzjgAA9tEAAIVxAAB6pgAA9+sAAC/qAAARwRdHGpoAAAbeSURBVHjazJhtaFTZGcd/997JJJMXR/OiCCaNbw0k0hhoUJrQUbcqWNhiWqhrNwS72G5XtIJivxQplMjiut2FglGpdEG3gm21H1yajU1xAobETdMMSdRWG83LZDSxZibmzkxmzj2nH3pnmKR502yKBy73OTP33vP8n+f/vJyjKaV42aFpWlL2+Xwv9e7hw4f3a5r2LvA1pdT5eDx+zul0/hh4Uyl1vqWl5deA8ng8C1Ls1q1bC1rXwRKOI0eOHAXeBYJKqXMPHjz4tKSk5NPjx49TWlpKQ0PDiba2NqOmpubY1q1bOXfu3MdCiM7W1tY2r9dreTwe+WXpoi8VyEOHDpUUFBR8dOrUqZL6+votubm5v121atUGt9tNaWkpBQUFeDweHA7Hsd27d1NSUkJNTQ2GYbwHOAHD6/Vqrz1QXde/uXHjRoqKiqioqGDv3r1kZWX9RNd1NE1D13XS0tLIyMggJycHh8PBihUrUEqtBDJstr3eQMvLyzUhxD8CgQBSSjRNY9OmTWiatmW+d5VSBuCqrq4+5fF4gsAH8Xh8g9fr1Rfj4SXzaH9/f9fAwADRaBTLsiguLkbX9Q2piWw2oBUVFW+WlpYevXDhQk5tbe1xwzB+anv4lcEuGVC/3x8XQnT19/cjhMDtdpOdnZ07PWunDsuyAFRWVtbbe/bsIS8vj3379qHr+o+A9MXQ2THXwguk6WwlRkkp/zk8PLxZCIFSisLCQkZHR9H1me0bjUaRUkaXLVu2s6ysjPT0dEzTRCk1BrgACVher1fOVOrmYMmMHjWA94HCVwXv8/kUIKWU/3r69CmWZSGlJD8/H03T5lNOKysrw+Vy4XA46O7uRgjRtcAEVWjrbsxXRwuAK8AbwNmXbASqNE3bpZT6c0tLS7ttSf/z58+xLAulFPn5+f9d1OGYAtYwjORcKaVXVlZOARqJRLoTMTpfLwP8DPg68BYwOhPQSuAPQJE9/zbwbJ4P/95uDH6+fv36X5aXl9Pd3X0SaGhrazsuhHgaCoWQUqKUoqqqCrfbTWZmJg6HgzVr1rBz584kqOLiYmpra3dUV1fjcrnQdZ2enh6CwWCPvd53gChgzaJPvn1/A+gAvgd8keQv8A4QAdRLXgCax+Pxt7e3q2fPninTNNXp06dVdXX1xc2bN++uq6tTAwMDKhwOKymlEkIoIYSSUibn8XhcWZb1P/OJiQm1fft2ZRjGFuArr6BfFHhHKZX0qLaI4qwD5uTkJJqmkZ6ezrFjx8jLy/vhxYsXnUKIpEE1TcMwpobPXPOenh6i0ejfLMuKAeIV9dNSqfsbwAf8MSUJvbcA6gIghLh49erV90+cOEFGRgYul4sDBw6QkZHx9vXr10lLS5sSk9M3EinxOeW5zs5OIpHI34EYEAd+YANWc1A3kVsGge9Op25qMmq2P1S0QIsZQHZVVdUnZ86cUYFAQJmmmaRofX29GhsbU+FwWFmWpcbHx1UoFFLxeFwNDw+rWCymhBAqEAgkZcuylGVZqq6uThUWFh4Avgrk2j3wXKPI1r3ZxjJreRkFdgEfzGG1mYb0+/0f3rhxg8bGRiYmJojFYiil2LZtG06nE8MwUErx4sULxsfHkVKSaBGny0opnjx5Ql9f37PBwcF7tkeFXUfnLJm27rtSM+5snZEFnLBdvyCQgPX48eOhkZGRvZcuXeLOnTtMTEwQj8dZu3ZtMu4SQCzLStbWxH26fPv2bSKRyB0bZMzWaz6gg7bu1ox19GU339M23qq8vFwAk3fv3m11Op1Hz549+/HKlStZt24dbrc7SR+lFFLKKfPEb9P/93q9jI2N/dXOnPFEbHo8nlfaeH9Zva60lQl3dXVdHR0d/aihoYFQKEQ0GkUIkfSi0+nE6XQipWT58uVJcG63OykPDQ3R29vLo0ePvgAm7W/LhZ46LBlQu+UTNsXMjo6OX927d+93165dwzRNYrFYkpLZ2dnk5OQAsHr16qQnU+WbN28SCoWuSCnNVKCvxX40BWwUmBgcHPywsbGRhw8fJr2aAJt6JbyYkIUQNDc34/f7P7ObmIXG5/9vm+bz+WQC7PDwcP/4+PgvLl++TDgcJhaLTUk2qZcQIknvzs5OhoaGfCMjI49so8UAazG0XZL9qA02DkQ7OjrO379//y/t7e2zerW3t5empibGxsaYnJykqamJYDD4GRBOSUTWYvVaqlNAaXsiYprmJ83Nzd+qrKxMnhUlRiAQ4OTJk4RCodYdO3Z8Y//+/XR0dNDX13fTBpqIT/VaArVLjgVM+ny+zzMzM68cPHjwrRlOFALBYPDznp6eP0kpv9/e3r7HNM3rsVjs34BpG0sulrYA/xkAtMtIYvSMrDMAAAAASUVORK5CYII=) 29 12, move"}).on("click mousedown mouseup touchstart touchend touchcancel contextmenu",function(e){if(e.preventDefault(),e.stopPropagation(),-1!==["click","mousedown","touchstart"].indexOf(e.type)){var t=U(this),a=e.offsetY;/^touch/.test(e.type)&&(a=e.originalEvent.touches[0].pageY-t.offset().top),d.popout(i,void 0,{offsetY:a,height:t.height()})}}).appendTo(i),o=function(){if(i.is(":visible")){i.css("max-width",_e()[0]),d.extra_spin_args.use_max_width||i.css("max-height",_e()[1]),d.extra_spin_args.use_container_height&&i.css("max-height","100%");var e=i.height(),t=i.width(),a=n.ceil(t/i.data("aspect"));i.height(a);var o=i.next(".sts-placeholder");o.css({"max-width":_e()[0],"max-height":_e()[1]}),o.height(o.width()/i.data("aspect")),r.css("z-index",t<200||a<150?1:-1),i.height()!==e&&i.triggerHandler("resize")}};d.recompute_size=o,i.on("aspect-change",o),U(e).resize(o),U(t).triggerHandler("aspect-change")};d.fullbrowser=function(){function i(e){var i=e.origin||"";if(d.iframeless_enabled||/https?:\/\/cdn(\.testenv)?\.impel\.io$/.test(i)){var a=e.data||"";if("string"==typeof a){var n=a.match(/^STS:FullBrowser::(\w+)$/);if(n&&(n=n[1],f[n])){d.iframeless_enabled&&(s=".sts-spin>div");var r=t.querySelectorAll(s);if(r.length){for(var o=0;o<r.length;o++){var c=r[o].contentWindow===e.source,l=d.iframeless_enabled&&d.spin.id===r[o].name;if(c||l){p=r[o];break}}f[n]()}}}}}function a(e){var t={};_.push(t);var i=function(i,a){t[i]=e.style[i],e.style[i]=a};i("position","relative"),i("zIndex","2147483647"),i("transform","none"),i("overflow","visible")}function n(e){var t=_.shift();Object.keys(t).forEach(function(i){e.style[i]=t[i]})}function r(){d.popout_handlers.forEach(function(e){e()});var e=p.parentNode;if(l=t.body,e&&!c){for(c=!0,u=l.style.overflow,l.style.overflow="hidden",e=e.parentNode;e!==l;)a(e),e=e.parentNode;d.iframeless_enabled||(p.style.width="100%",p.style.height="100%",p.style.zIndex="2147483647",p.style.top="0",p.style.left="0",p.style.position="fixed");var i=t.querySelector(".sts_spin_container");i&&(i.style.display="block")}}function o(){d.popin_handlers.forEach(function(e){e()});var e=p.parentNode;if(e&&c){for(c=!1,l.style.overflow=u,e=e.parentNode;e!==l;)n(e),e=e.parentNode;p.style.width="1px !important",p.style.height="1px !important",p.style.zIndex="0 !important",p.style.top="",p.style.left="",p.style.position="";var i=t.querySelector(".sts_spin_container");i&&(i.style.display="none"),p=null}}var s=".sts-spin>iframe",c=!1,l=t.body,u="";e.addEventListener("message",i,!1);var p,_=[],f={open:r,close:o,isFull:c};return f}(),d.initFeatureHighlightsFullBrowser=function(){function i(e){var t={};l.push(t);var i=function(i,a){t[i]=e.style[i],e.style[i]=a};i("position","relative"),i("zIndex","2147483647"),i("transform","none"),i("overflow","visible")}function a(e){var t=l.shift();Object.keys(t).forEach(function(i){e.style[i]=t[i]})}function n(){var e=c.parentNode;if(d=t.body,e&&!u){for(u=!0,s=d.style.overflow,d.style.overflow="hidden",e=e.parentNode;e!==d;)i(e),e=e.parentNode;c.style.width="100%",c.style.height="100%",c.style.zIndex="2147483647",c.style.top="0",c.style.left="0",c.style.position="fixed"}}function r(){var e=c.parentNode;if(e&&u){for(u=!1,d.style.overflow=s,e=e.parentNode;e!==d;)a(e),e=e.parentNode;c.style.width="1px !important",c.style.height="1px !important",c.style.zIndex="0 !important",c.style.top="",c.style.left="",c.style.position="",c=null}}function o(e){if(/https?:\/\/cdn\.impel\.io$/.test(e.origin||"")){var i=e.data||"";i&&"string"==typeof i&&i.match(/^STS:feature-highlights::(\w+)$/)&&(c=t.getElementById("spincar-feature-highlights"),"STS:feature-highlights::expand"===e.data?n():"STS:feature-highlights::close"===e.data&&r())}}var s,c,l=[],d=t.body,u=!1;e.addEventListener("message",o,!1)},d.get_colors=function(){var e=d.colormap.default;return d.ui_skin_custom&&d.ui_skin_custom[0]&&(d.ui_skin_custom[2]&&(e[2]=d.ui_skin_custom[0]),d.ui_skin_custom[3]&&(e[0]=d.ui_skin_custom[0]),d.ui_skin_custom[3]&&(e[1]=d.ui_skin_custom[0])),e};var he=function(e){for(var t=5381,i=e.length;i;)t=33*t^e.charCodeAt(--i);return t>>>0};!function(){var e=function(){return d.args.regionerbaseurl?d.args.regionerbaseurl:d.args.testregioner?"https://"+d.args.testregioner+"-regioner.testenv.impel.io/":d.args.devregioner?"string"==typeof d.args.devregioner?"http://192.168.0."+d.args.devregioner+":8779/":"http://localhost:8779/":"https://regioner.impel.io/"},t=!1;d.regioner=function(i){t||(t=!0,d.read_cached_url(e()+i,{success:function(e){d.region=e.region,d.region||c.log('Error: Invalid S3 folder "'+i+'", cannot find its region.')},error:function(){c.log("Error: Neither regioner nor cache is available, cannot find region.")}},{dev:d.args.devregioner,dev_cache:d.args.devregioner&&d.args.devregionercache}))}}(),d.get_feature_highlights_url=function(t,i){i=i||d.customer;var n=d.feature_highlights_color,o=d.fh_bg_color,s=d.fh_title_color,c=d.send_asc_formatted_events,l=d.hidden_fh_title,u=d.enterprise_theme,p=U("html").attr("lang")||U('meta[http-equiv="Content-Language"]').attr("content")||"en";"www.webmotors.com.br"===location.host&&(p="pt-BR");var _=d.STATIC_PREFIX+"fh/index.html?_=eec19073c9f653#!customer="+r(i)+"!vin="+r(t)+"!canonicalhostname="+r(d.canonical_hostname)+"!static_env="+d.static_env+"!vinifierbaseurl="+a()+"!lang="+p+(n?"!accent_color="+n.replace(/#/g,""):"")+(o?"!backgroundcolor="+o.replace(/#/g,""):"")+(s?"!titlecolor="+s.replace(/#/g,""):"")+(c?"!sendascevents="+c:"")+(l?"!hidetitle":"")+(u?"!enterprisetheme="+u:"");if(d.args.devanalytics?_+="!devanalytics="+d.args.devanalytics:d.args.testanalytics&&(_+="!testanalytics="+d.args.testanalytics),_=v(_),d.region&&(_+="!fhregion="+d.region),d.canonical_hostname&&(_+="!canonicalhostname="+d.canonical_hostname),d.partner&&(_+="!partner="+d.partner),c&&e.asc_datalayer&&e.asc_datalayer.items){var f=e.asc_datalayer.items.find(function(e){return e.item_id===t.toLowerCase()});f=Object.assign(f||{},{page_type:d.page_type});var h=JSON.stringify(f),g=r(h);_+="!asc_item="+g}return U.each(["teststatic","testga"],function(e,t){var i=d.args[t];i&&(_+="!"+t,!0!==i&&(_+="="+r(i)))}),_},d.get_spin_url=function(e,t){t=t||d.customer;var i=U("html").attr("lang")||U('meta[http-equiv="Content-Language"]').attr("content")||"en";U("html").attr("lang",i);var a=d.STATIC_PREFIX+"20190909/?_=eec19073c9f653#!customer="+r(t)+"!vin="+r(e)+(d.partner?"!partner="+r(d.partner):"")+"!canonicalhostname="+r(d.canonical_hostname)+"!stscolor="+r(d.get_colors().join(",").replace(/#/g,""))+"!lang="+r(i)+"!enterprisetheme="+(d.enterprise_theme?d.enterprise_theme:"")+(d.feature_highlights_enabled?"!featurehighlightsenabled":"")+(d.popout_enabled?"!popoutenabled":"")+(d.region?"!region="+r(d.region):"")+("pilot"===d.static_env?"!pilot":"")+(d.hidden_damage?"!hidedamage":"")+(d.show_placeholder&&!d.injection_done?"!showplaceholder":"");return a=v(a),U.each(["arrowskin","devvinifier","devvinifiercache","forcestartmodal","teststatic","testvinifier","vinifierbaseurl","managerbaseurl","testremoteenv","testga"],function(e,t){var i=d.args[t];i&&(a+="!"+t,!0!==i&&(a+="="+r(i)))}),U.each(d.extra_spin_args,function(e,t){t&&(a+="!"+e,!0!==t&&(a+="="+r(t)))}),U.each(d.args.UI,function(e,t){a+="!"+e,!0!==t&&(a+="="+r(t))}),a};var ge=A();d.checkOptout=function(){return A()||ge},d.optout=function(){ge=!0},function(){function a(e){"webpagedata"===e.event&&e.data&&e.data.shid&&e.data.cid?(w.shopper_id=e.data.shid,w.shopper_source=e.data.cid,R.push(e)):"vehicle"==e.event&&R.push(e),B&&y(),ee()}function n(){if(A&&(w.features[A].dur+=ce.stop("wa_feature")),S&&(w.ft_features[S].dur+=ce.stop("ft_feature"),w.ft_features[S].dur_autoplay_paused+=ce.stop("ft_autoplay"),w.ft_total_duration+=ce.stop("view_ft")),k&&x&&("carousel_click"===x?w.carousel_clicks[k].dur+=ce.stop("closeup"):w.features[k].dur+=ce.stop("closeup")),"walkaround"===C&&(w.view_time_spin+=ce.stop("walkaround")),E&&(w.view_clicks_and_times[E].dur+=ce.stop("wa_view")),z){var e=ce.stop("feature_redesign");w.feature_views_and_times[z].dur+=e,w.total_feature_time+=e}if(I){var t=ce.stop("photo");w.photo_views_and_times[I].dur+=t,w.total_photo_time+=t}if(j){var i=ce.stop("video");w.video_views_and_times[j].dur+=i,w.total_video_time+=i}if(L){var a=ce.stop("carousel_category");w.category_clicks_and_times[L].dur+=a}}function o(){if(!Z||K){var e=U(1===U("iframe").length?"iframe":'iframe[name*="sts"]');e.length&&e[0].contentWindow.postMessage("ga_time_events:"+JSON.stringify(w),"*")}}function l(t){var i=d.ga_client_id?d.ga_client_id:null;e.asc_datalayer&&void 0===e.asc_datalayer.page_type&&(e.asc_datalayer.page_type=d.page_type);var a=d.send_asc_formatted_events||d.ga_asc_vinifier?e.asc_datalayer:null,n={ga_client_id:i,ga_asc_datalayer:a},r=JSON.stringify(n);t.contentWindow.postMessage("STS:GAInit:::"+r,"*")}function u(t){d.ga_client_id?l(t):e.gtag&&d.ga4_measurement_id?gtag("get",d.ga4_measurement_id,"client_id",function(e){e&&(d.ga_client_id=e,l(t))}):l(t)}function p(t){var i=e[d.tealium_tag_name];if(d.tealium_tag_name&&i){void 0===e.asc_datalayer.page_type&&(e.asc_datalayer.page_type=d.page_type);var a=d.send_asc_formatted_events||d.ga_asc_vinifier?e.asc_datalayer:null;if(a){var n={visitor_id:i.data.tealium_visitor_id,asc_datalayer:a,account:i.data.tealium_account,profile:"impel",tag_name:d.tealium_tag_name},r=JSON.stringify(n);t.contentWindow.postMessage("STS:TealiumInit:::"+r,"*")}}}function _(){var e=t.querySelectorAll("iframe"),i=1===e.length?e[0]:t.querySelector('iframe[name*="sts"]');i&&s(function(){u(i)},1e3)}function f(){var e=t.querySelector('iframe[name="impel-feature-highlights"]');e&&u(e)}function h(){var e=t.querySelectorAll("iframe"),i=1===e.length?e[0]:t.querySelector('iframe[name*="sts"]');i&&s(function(){p(i)},1e3)}function g(e){var t=e.data;"string"==typeof t&&("STS:GAInit:Spin"===t&&(le<2||"srp"===d.page_type)?(++le,_()):("STS:GAInit:FH"===t&&de<2||"srp"===d.page_type)&&(++de,f()))}function v(t){var i=t.data;"string"==typeof i&&("STS:TealiumInit:Spin"===i&&ue<2&&(++ue,h()),2===ue&&e.removeEventListener("message",v))}function m(e){var t,i,a=d.page_type?d.page_type:d.analytics2.page_type;te&&(t=te.id,i=te.group),ImpelAna.configure({optout:d.checkOptout(),transmit:[{type:"aws",service:"firehose",dest:"delivery_stream_name",aws_region:"eu-west-1",data:{delivery_stream_name:"datalake-suite-ingest-prod-static-delivery-stream"},auth:{type:"cognito",key:"identity_pool_id",data:{identity_pool_id:"eu-west-1:bd26e474-2a29-4529-bbb8-6f21b9aec324"}}}],schema_version:"3",page_type:a,spin:e.spin,exp_id:t,exp_group:i}),X=!0}function y(){if(R.length)for(;R.length>0;){var e=R.shift();e.event&&e.data&&Object.keys(e.data).length&&ImpelAna.meta(e.event,e.data)}}var w,b,k,x,A,S,C,O,E,T,I,j,L,P,F,D=!1,N=!1,z=null,q=null,W=!1,M={eu:"eu-west-1",us:"us-east-1"},R=[],B=!1,X=!1,Y=0,Z=!0==!!d.args.teststatic,K=d.args.devanalytics||d.args.testanalytics;d.postParent=function(t){try{postMessage.call(opener||parent,t,"*")}catch(i){(e.opener||e.parent).postMessage(t,"*")}};var $=function(e){if(d.args.postanalytics){try{new URL(d.args.postanalytics)}catch(e){return}d.postParent("sts-post-analytics:"+JSON.stringify({event:e}),d.args.postanalytics)}};d.Analytics2={},d.Analytics2.lead=function(e){if("spincar"===e||!d.page_type||"vdp"===d.page_type){e=e?e+"_lead":"lead",F="lead";try{if(w[e])return;w[e]=!0,ee(D)}catch(e){try{c.log("content/integrate.js:2\nintegration/integrate-main.js:62\nintegration/integrate-base.js:465\nanalytics/analytics2.js:83\n",function(){try{return(new Error).stack+"\n"}catch(e){}}(),"problem recording lead",e.message,e.stack)}catch(e){}}}},d.Analytics2.srp_click=function(t,i,a){d.analytics2.vin=t,d.analytics2.spin=i,d.analytics2.page_type="srp",d.addWidgetToImpelAna(),U(e).on("message.sts_vehicle_data",H);var n=new MutationObserver(function(){U(a).length||(n.disconnect(),ie(),C=null)});n.observe(U(a).parent()[0],{childList:!0})},d.Analytics2.is_popout_only=function(){N=!0,C=null,ce.stop("walkaround"),w.num_views_spin=0},d.Analytics2.popout_button_click=function(){ce.start("walkaround"),C="walkaround",++w.num_views_spin,$("view_360_popout")},d.Analytics2.popout_view_closed=function(){n(),o(),ce.resetAll(),C=null},d.Analytics2.provider_script_loaded=function(e,t){a({event:"vehicle",data:{s3:e,vid:t,source:"provider_script"}})};var ee=d.Analytics2.SendNow=function(t){if(!(Z&&!K||d.checkOptout()))try{if(!w.client_id||!w.prid)return;if(/\btruecar.com$/.test(e.location.hostname))return void c.log("Impel analytics suppressed for TRUECar.");if(/\b.+\.kijiji\.ca$/.test(e.location.hostname))return void c.log("Impel analytics suppressed for Kijiji.");if(/\bused-uk.kia.com$/.test(e.location.hostname))return void c.log("Impel analytics suppressed for used-uk.kia.com.");if((w.vin||"").length>100||/[^\x00-\x7F]|\n/g.test(w.vin||"")){w.vin=w.vin.replace(/[^\x00-\x7F]|\n/g,"");var i=w.vin.substring(0,100)+"...",a="Long VIN "+i+" on page "+location.href;return c.log(a),void ne(a,!0,!0)}if(w.duration=P?1*new Date-P:null,d.args.testanalytics||d.args.devanalytics){var n=!1;try{n=e.self!==e.top}catch(e){n=!0}n&&(parent.postMessage(w,"http://sts-static-testenv.s3.amazonaws.com"),parent.postMessage(w,"http://mythicalmotors.testenv.impel.io/"))}ne(w,!t,!1)}catch(e){try{c.log("content/integrate.js:2\nintegration/integrate-main.js:62\nintegration/integrate-base.js:465\nanalytics/analytics2.js:200\n",function(){try{return(new Error).stack+"\n"}catch(e){}}(),"problem sending analytics",e.message,e.stack)}catch(e){}}},ie=d.Analytics2.reinitialize=function(){P=P?1*new Date:d.load_start,w&&ee(),w=d.analytics2={v:3,carousel_clicks:{},client_id:null,prid:null,lead:!1,spincar_lead:!1,num_clicks_vdp:0,num_clicks_spin:0,num_clicks_360:0,num_clicks_feature:0,duration:0,spin_latency:null,vin:null,s3_folder:null,url:null,spin:null,missing_script_integration:null,features:{},canonical_hostname:d.canonical_hostname,device:function(){var e=i.userAgent.match(/Android|iPhone|iPad|iPod|Windows Phone|Mac OS X|Windows NT/);return e||(e=i.userAgent.match(/Linux/)),e?e[0]:"Other"}(),misc:null,page_type:null,customer_id:null,ft_back_button_features:null,ft_closed_locations:null,ft_features:{},ft_video_features:{},ft_menu_clicks:null,ft_paused_features:null,ft_preferences:null,ft_skipped_features:null,ft_total_duration:0,is_ft_autoplay_enabled:null,num_clicks_ft:0,num_views_feature_tour:0,num_views_video_tour:null,num_views_still_image:null,num_views_spin:0,view_time_video_tour:null,view_time_spin:0,carfax_link_clicked:!1,num_clicks_hotspots:0,view_clicks_and_times:{},category_clicks_and_times:{},feature_category_clicks:{},feature_views_and_times:{},total_feature_clicks:0,total_feature_time:0,fi_views_and_times:{},total_fi_clicks:0,total_fi_time:0,photo_views_and_times:{},total_photo_clicks:0,total_photo_time:0,video_category_clicks:{},video_views_and_times:{},total_video_clicks:0,total_video_time:0,num_clicks_cta:0,num_clicks_cta_interstitial:0};var e=setInterval(function(){t.body&&(clearInterval(e),b=t.createElement("iframe"),b.id=b.name="sts-analytics2-iframe",b.style.visibility="hidden",b.style.border="none",b.style.zIndex=-1e14,b.style.position="absolute",b.style.left=b.style.top="-1000px",b.style.width=b.style.height="1px",b.src="",t.body.appendChild(b),s(function(){b.src="https:"+Q+"ana2/client_id.html?_=eec19073c9f653"},0))},50)},ae=0,ne=function(t,a,n){var o=M[d.region];if(!o)return void(ae<5?(s(function(){ne(t,a,n)},1e3),ae++):c.log("Error: Invalid region or region not ready. Analytics not sent."));t=V(t);var l="Action=SendMessage&MessageBody="+r(G(t))+"&Version=2012-11-05",u="prod_analytics",p="505055843994";(d.args.testanalytics||d.args.devanalytics)&&(p="901863237878"),d.args.devanalytics?u="dev_"+d.args.devanalytics+"_analytics":d.args.testanalytics&&(u=d.args.testanalytics+"_analytics"),n&&(u+="_error"),u+=d.region&&"us"!==d.region?"_"+d.region:"";var _="https://sqs."+o+".amazonaws.com/"+p+"/"+u;if(e.XDomainRequest){var f=new Image;f.src=_+"?"+l,f.onload=f.onerror=function(){f=void 0}}else i.sendBeacon&&i.sendBeacon(_,new Blob([l],{type:"application/x-www-form-urlencoded"}))},re=function(){d.postParent("sts-sa-ana:"+JSON.stringify({category:"click",event:{t:"vdp",a:F,g:"vdp"}})),F&&(F=void 0)};U(function(){U("body").click(function(){W=!0,w.num_clicks_vdp++,re()})});var oe=function(e,t){return w[e]||(w[e]=t),w[e]},se=function(e,t){var i=oe(e,[]);-1===i.indexOf(t)&&i.push(t)},ce=function(){function e(e){a[e]=1*new Date}function t(e){if(!a[e])return 0;var t=1*new Date-a[e];return a[e]=null,t}function i(){a={}}var a={};return{start:e,stop:t,resetAll:i}}();d.configureImpelAna=function(e){var t=setInterval(function(){if(!B&&Y<=5)return void Y++;clearInterval(t),B&&(m(e||{}),y())},50*(1+Y))},d.addWidgetToImpelAna=function(){if(B&&X)ImpelAna.addWidget(d.spin_exists||d.analytics2.spin);else var e=0,t=setInterval(function(){if((!B||!X)&&e<=5)return void e++;clearInterval(t),B&&X&&ImpelAna.addWidget(d.spin_exists||d.analytics2.spin)},50*(1+e))},U(e).on("message",function(i){var a=i.originalEvent.data;if("string"==typeof a){var n,r;if(0===a.indexOf("sts_client_id_prid:")){var o=J(a.substring(19));w.client_id=o.client_id;w.prid=o.prid+":"+function(e,t){return Array(1+t).slice((""+e).length).join("0")+e}(he(d.canonical_hostname),10),-1!==e.location.href.indexOf("spins.impel.io")&&t.referrer?w.url=t.referrer:w.url=e.location.href,ee(),b.parentNode.removeChild(b)}if(0===a.indexOf("sts-gs-ana:")){W=!0;var s=J(a.substring(11));if(s.hasOwnProperty("spin_click")&&++w.num_clicks_spin,s.hasOwnProperty("action_click")&&(oe("action_click",{})[s.action_click]=!0),s.hasOwnProperty("feature_tour_click")&&++w.num_clicks_ft,s.hasOwnProperty("previous_feature")&&se("ft_back_button_features",s.previous_feature),s.hasOwnProperty("skipped_feature")&&se("ft_skipped_features",s.skipped_feature),s.hasOwnProperty("clicked_feature_from_menu")&&se("ft_menu_clicks",s.clicked_feature_from_menu),s.hasOwnProperty("misc")&&(w.misc||(w.misc=s.misc)),s.hasOwnProperty("close_video")&&S&&(w.ft_video_features[S].dur+=ce.stop("ft_video")),s.hasOwnProperty("is_ft_autoplay_enabled")&&(w.is_ft_autoplay_enabled=s.is_ft_autoplay_enabled),s.hasOwnProperty("autoplay_start")&&(O&&(w.ft_features[S].dur_autoplay_paused+=ce.stop("ft_autoplay")),O=!1),s.hasOwnProperty("autoplay_pause")&&(se("ft_paused_features",s.autoplay_pause),O=!0,ce.start("ft_autoplay")),s.hasOwnProperty("preferences")&&(Array.isArray(s.preferences)?w.ft_preferences=s.preferences:se("ft_preferences",s.preferences)),s.hasOwnProperty("opened_feature_tour")&&(C="feature-tour",ce.start("view_ft"),++w.num_views_feature_tour),s.hasOwnProperty("video_tour_click")&&("walkaround"===C?w.view_time_spin+=ce.stop("walkaround"):"photo"===C&&k&&(w.carousel_clicks[k].dur+=ce.stop("closeup")),C="video",w.num_views_video_tour?++w.num_views_video_tour:w.num_views_video_tour=1),s.hasOwnProperty("video_tour_duration")&&(C="walkaround",++w.num_views_spin,ce.start("walkaround"),w.view_time_video_tour?w.view_time_video_tour+=s.video_tour_duration:w.view_time_video_tour=s.video_tour_duration),s.hasOwnProperty("current_product")&&("walkaround"===s.current_product&&"walkaround"!==C&&(++w.num_views_spin,ce.start("walkaround")),"photo"===s.current_product&&"photo"!==C&&++w.num_views_still_image,"walkaround"!==s.current_product&&"walkaround"===C&&(w.view_time_spin+=ce.stop("walkaround")),C=s.current_product),s.hasOwnProperty("play_video_click")&&(w.ft_video_features[S]||(w.ft_video_features[S]={dur:0,views:0}),ce.start("ft_video"),++w.ft_video_features[S].views),s.hasOwnProperty("feature")){if(A&&(w.features[A].dur+=ce.stop("wa_feature")),ce.start("wa_feature"),!(A=s.feature))return;w.features[A]||(w.features[A]={dur:0,clicks:0}),++w.num_clicks_feature,++w.features[A].clicks}if(s.hasOwnProperty("tour_close_location")&&(C="walkaround",++w.num_views_spin,se("ft_closed_locations",s.tour_close_location),w.ft_total_duration+=ce.stop("view_ft"),S&&(w.ft_video_features[S]&&(w.ft_video_features[S].dur+=ce.stop("ft_video")),w.ft_features[S]&&(w.ft_features[S].dur+=ce.stop("ft_feature")),O&&(w.ft_features[S].dur_autoplay_paused+=ce.stop("ft_autoplay")))),s.hasOwnProperty("client_id_prid")){var c=e.location.href.match(/spins.impel.io/g),l=c?t.querySelector("iframe"):t.querySelector('iframe[name*="sts"]'),u=c?"":d.get_analytics_link();l.contentWindow.postMessage("client_id_prid:"+w.client_id+","+w.prid+","+u,"*"),l&&l.contentWindow.postMessage("client_id_prid:"+w.client_id+","+w.prid+","+u,"*")}if(s.hasOwnProperty("view_feature")){if(w.ft_features[s.view_feature]||(w.ft_features[s.view_feature]={category:null,dur:0,views:0,dur_autoplay_paused:0}),S){var p=ce.stop("ft_feature");w.ft_features[S].dur+=p,w.total_feature_time+=p,O&&(w.ft_features[S].dur_autoplay_paused+=ce.stop("ft_autoplay"))}if(ce.start("ft_feature"),O&&ce.start("ft_autoplay"),!(S=s.view_feature))return;w.ft_features[S].category=s.view_category,++w.ft_features[S].views,++w.total_feature_clicks}if(s.hasOwnProperty("ft_menu_opened")&&(S&&(w.ft_features[S].dur+=ce.stop("ft_feature"),O&&(w.ft_features[S].dur_autoplay_paused+=ce.stop("ft_autoplay"))),S=null),s.hasOwnProperty("closeup")){if(r=function(){return"hotspot_click"===x?"features":"carousel_clicks"},k&&x&&(w[r()][k].dur+=ce.stop("closeup")),ce.start("closeup"),k=s.closeup,x=s.mode,!k||!x)return;n=function(e){w[e][k]||(w[e][k]={dur:0,clicks:0}),++w[e][k].clicks},C="features"===r()?"walkaround":"photo",n(r()),++w.num_clicks_feature}if(s.hasOwnProperty("carfax_link_clicked")&&(w.carfax_link_clicked=!0),s.hasOwnProperty("hotspot_toggle_click")&&$(s.hotspot_toggle_click?"view_hotspots":"hide_hotspots"),s.hasOwnProperty("wa_view_clicked")){if(!s.wa_view_clicked||s.wa_view_clicked===E)return;"i"===s.wa_view_clicked||"pano_0"===s.wa_view_clicked?$("view_interior"):"ec"===s.wa_view_clicked&&$("view_exterior"),w.view_clicks_and_times[s.wa_view_clicked]||(w.view_clicks_and_times[s.wa_view_clicked]={dur:0,views:0}),E&&w.view_clicks_and_times.hasOwnProperty(E)&&(w.view_clicks_and_times[E].dur+=ce.stop("wa_view")),ce.start("wa_view"),E=s.wa_view_clicked,++w.view_clicks_and_times[E].views}if(s.hasOwnProperty("feature_clicked")){var _=s.feature_clicked,f=s.feature_category,h=s.feature_key,g=s.opened_from;if(_===z)return;if(null!==_&&(w.feature_views_and_times[_]||(w.feature_views_and_times[_]={category:f,key:h,drawer_views:0,dur:0,non_drawer_views:0})),z){var v=ce.stop("feature_redesign");w.feature_views_and_times[z].dur+=v,w.total_feature_time+=v}null!==_?(ce.start("feature_redesign"),z=_,++w.total_feature_clicks,"hotspot"===g&&++w.num_clicks_hotspots,"drawer"===g?++w.feature_views_and_times[_].drawer_views:++w.feature_views_and_times[_].non_drawer_views):z=null}if(s.hasOwnProperty("fi_product_clicked")){var m=s.fi_product_clicked;if(m===T)return;if(T){var y=ce.stop("financeInsurance");w.fi_views_and_times[T].dur+=y,w.total_fi_time+=y}null!==m?(w.fi_views_and_times[m]||(w.fi_views_and_times[m]={
drawer_views:0,dur:0,non_drawer_views:0}),ce.start("financeInsurance"),T=m,++w.total_fi_clicks,"drawer"===s.opened_from?++w.fi_views_and_times[m].drawer_views:++w.fi_views_and_times[m].non_drawer_views):T=null}if(s.hasOwnProperty("photo_clicked")){var P=s.photo_clicked,F=s.opened_from;if(P===I)return;if(null!==P&&(w.photo_views_and_times[P]||(w.photo_views_and_times[P]={drawer_views:0,drawer_dur:0,non_drawer_dur:0,non_drawer_views:0,name:s.name})),I){var D=ce.stop("photo");"drawer"===q||"photoViewer"===q?w.photo_views_and_times[I].drawer_dur+=D:w.photo_views_and_times.hasOwnProperty(I)?w.photo_views_and_times[I].non_drawer_dur+=D:w.photo_views_and_times[I]={drawer_views:0,drawer_dur:0,non_drawer_dur:D,non_drawer_views:0,name:s.name},w.total_photo_time+=D}null!==P?(ce.start("photo"),I=P,++w.total_photo_clicks,"hotspot"===F&&++w.num_clicks_hotspots,"drawer"===F||"photoViewer"===F?(++w.photo_views_and_times[P].drawer_views,"drawer"!==q&&++w.num_views_still_image,q="drawer"):(++w.photo_views_and_times[P].non_drawer_views,q="non_drawer")):(I=null,q=null)}if(s.hasOwnProperty("video_clicked")){var N=s.video_clicked;if(N===I)return;if(null!==N&&(w.video_views_and_times[N]||(w.video_views_and_times[N]={dur:0,views:0})),j){var M=ce.stop("video");w.video_views_and_times[j].dur+=M,w.total_video_time+=M}null!==N?(ce.start("video"),j=N,++w.total_video_clicks,++w.video_views_and_times[N].views):j=null}if(s.hasOwnProperty("feature_category_card_clicked")&&(w.feature_category_clicks[s.feature_category_card_clicked]||(w.feature_category_clicks[s.feature_category_card_clicked]=0),++w.feature_category_clicks[s.feature_category_card_clicked]),s.hasOwnProperty("video_category_card_clicked")&&(w.video_category_clicks[s.video_category_card_clicked]||(w.video_category_clicks[s.video_category_card_clicked]=0),++w.video_category_clicks[s.video_category_card_clicked]),s.hasOwnProperty("carousel_category_changed")){var H=s.carousel_category_changed;if(H===L)return;if(null!==H&&(w.category_clicks_and_times[H]||(w.category_clicks_and_times[H]={dur:0,clicks:0})),L){var R=ce.stop("carousel_category");w.category_clicks_and_times[L].dur+=R}null!==H?(ce.start("carousel_category"),L=H,++w.category_clicks_and_times[H].clicks):L=null}s.hasOwnProperty("num_clicks_cta")&&++w.num_clicks_cta,s.hasOwnProperty("num_clicks_cta_interstitial")&&++w.num_clicks_cta_interstitial,s.hasOwnProperty("wa_360_click")&&++w.num_clicks_360}if(0===a.indexOf("sts-sa-ana:")&&B){var U=J(a.substring(11));try{ImpelAna.emit(U.category,U.event)}catch(i){}}if(0===a.indexOf("sts-aa-ana:")){var s=J(a.substring(11));e.digitalData&&e.digitalData.newEvent({type:"CustomTagEvent",eventName:"CTA",eventAction:"buttonClick",attributes:s})}}}),e.addEventListener("message",function(e){if("string"==typeof e.data)if(/^STS:JSON::/.test(e.data))try{var t=J(e.data.substring(10));a(t)}catch(e){return}else if(/^sts_vehicle_data:/.test(e.data))try{s(function(){var t=JSON.parse(/:(.*)$/.exec(e.data)[1]);a({event:"vehicle",data:{s3:t.s3_folder,vid:t.vin}})},1e3)}catch(e){return}}),U(e).on("beforeunload",function(){D=!0,n(),ee(!0),o()});var le=0,de=0,ue=0;e.addEventListener("message",g),e.addEventListener("message",v);var pe=1e4,_e=1*new Date;setInterval(function(){W&&(pe=1e4,W=!1),_e+pe>1*new Date||(pe*=1.5,_e=1*new Date,ee())},1e3),function(){var e=t.createElement("script");t.head.appendChild(e),e.onload=function(){B=!0};var i="https://";d.args.teststatic?(i+="cdn.impel.io/static-test/",i+=d.args.teststatic):i+="cdn.impel.io/spincar-static",i+="/releases/analytics/ImpelAna%400.0.10/ana.min.js",e.src=i}(),ie()}();var ve=function(t){if(t&&t.contentWindow&&!d.vr_mode_workaround_active){var i=0;e.addEventListener("deviceorientation",function(a){1*new Date-i<20||(i=1*new Date,t.contentWindow&&t.contentWindow.postMessage({type:"deviceorientation",alpha:a.alpha,beta:a.beta,gamma:a.gamma,orientation:screen.orientation?screen.orientation.angle:e.orientation},"*"))});var a=0;addEventListener("message",function(e){e=e.data,e.hasOwnProperty("type")&&"deviceorientation"===e.type&&(1*new Date-a<20||(a=1*new Date,t.contentWindow&&t.contentWindow.postMessage({type:"deviceorientation",alpha:e.alpha,beta:e.beta,gamma:e.gamma,orientation:e.orientation},"*")))},!0),d.vr_mode_workaround_active=!0}};d.criteo=d.criteo||{},d.criteo.send=function(){if(!d.checkOptout()&&d.criteo.account_id&&("0"===d.criteo.account_id&&(d.criteo.account_id=E()),"00"===d.criteo.account_id&&(d.criteo.account_id=T()),"000"===d.criteo.account_id&&(d.criteo.account_id=O()),"0000"===d.criteo.account_id&&(d.criteo.account_id=S()),"00000"===d.criteo.account_id&&(d.criteo.account_id=I()),"000000"===d.criteo.account_id&&(d.criteo.account_id=j()),"0000000"===d.criteo.account_id&&(d.criteo.account_id=C()),"00000000"===d.criteo.account_id&&(d.criteo.account_id=L()),"000000000"===d.criteo.account_id&&(d.criteo.account_id=P()),"0000000000"===d.criteo.account_id&&(d.criteo.account_id=F()),d.criteo.account_id)){var t=[];if("srp"===d.page_type)for(t=d.srp_vins.slice(0,3);t.length<3;)t.push("");else"vdp"===d.page_type&&t.push(U.trim(d.criteo_vin)||d.vin);if(-1!==["53066","44592","57299"].indexOf(d.criteo.account_id))for(var a=0;a<t.length;a++)t[a]="1";c.log("spincar adtech",d.criteo.account_id,d.page_type,t);var n;n=/iPad/.test(i.userAgent)?"t":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Silk/.test(i.userAgent)?"m":"d",e.criteo_q=e.criteo_q||[],e.criteo_q.push({event:"setAccount",account:d.criteo.account_id},{event:"setSiteType",type:n});var r=["hondaofkeene.com","toyotakeene.com","johnsonkiaannapolis.com"];if("homepage"===d.page_type)e.criteo_q.push({event:"viewHome"});else if("srp"===d.page_type)e.criteo_q.push({event:"viewList",item:t});else if("vdp"===d.page_type)e.criteo_q.push({event:"viewItem",item:t[0]});else{if(-1===r.indexOf(d.canonical_hostname))return;(function(e){return(e.includes("/contact-form-confirm.htm")||e.includes("/form/confirm.htm"))&&e.includes("INVENTORY_LEAD")})(e.location.href)&&function(){e.criteo_q=e.criteo_q||[];var t=e.DDC.dataLayer.confirmation.vin||"",i=(new Date).getTime();e.criteo_q.push({event:"trackTransaction",id:i,item:[{id:t,price:1,quantity:1}],tms:"custom-guide"})}()}U.getScript("//dynamic.criteo.com/js/ld/ld.js?a="+d.criteo.account_id),d.criteo_audit={account_id:d.criteo.account_id,page_type:d.page_type,vins:t,type:n},d.analytics2.criteo_audit=d.criteo_audit}},U(e).one("page_type",d.criteo.send),d.tracking_only&&(d.analytics2.tracking_only=!0),d.get_analytics_link=function(){if(d.analytics2.client_id&&d.customer){var e="https://manager.impel.ai/";return d.args&&d.args.managerbaseurl&&(e=d.args.managerbaseurl),e+"shopper-intelligence-report/"+D(d.customer)+"/"+d.analytics2.client_id}},d.add_analytics_link=function(e,t){void 0===t&&(t="\r\n--\r\nThis customer interacted with SpinCar. To view their interaction on your website, copy and paste this link into a browser:\r\n");try{var i=d.get_analytics_link().replace(/^(?:https?:)?\/\//,"")}catch(e){return!1}return!(!i||-1!==e.indexOf(i))&&(e=U.trim(e)+"\r\n"+t+i)},d.add_analytics_link_html=function(e,t){var i=d.get_analytics_link(),a=U("<a>").attr("href",i).html("SpinCar Lead Intelligence Report"),n=U("<div>").append(a).html();return n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"escape"===t&&(n=n.replace(/"/g,"&quot;").replace(/'/g,"&#039;")),"replace"===t&&(n=n.replace(/"/g,"'")),!(!n||-1!==e.indexOf(n))&&(e=U.trim(e)+"\r\n\r\n"+n)};var me=setInterval(function(){void 0!==(e.SpinCarLeadReportUrl=d.get_analytics_link())&&clearInterval(me)},50);d.navigated=function(){d.load_start=1*new Date,d.vin=void 0,d.Analytics2.reinitialize(),d.retry_timeout&&(clearTimeout(d.retry_timeout),d.retry_timeout=void 0)};var ye=function(){var e={vin:""};return d.vin&&(e.vin=d.vin),d.vehicle_data&&d.vehicle_data.info&&(e.make=d.vehicle_data.info.make||"",e.model=d.vehicle_data.info.model||"",e.year=d.vehicle_data.info.year||""),e},we=function(){"object"==typeof preact&&(oe=!0);var e=t.createElement("script");e.src="https://cdnjs.cloudflare.com/ajax/libs/preact/10.23.1/preact.min.js",e.onload=function(){oe=!0},t.head.append(e)},be=function(){const e="https:"+d.STATIC_PREFIX+"releases/feature-highlights/feature-highlights%40LATEST/";var i=t.createElement("script");i.src=e+"impel-feature-highlights.js",t.head.append(i),i.onload=function(){ce=!0},i.onerror=function(){throw new Error("CRITICAL: Failed to load IIFE FH module.")};const a=t.createElement("link");a.href=e+"impel-feature-highlights-style.css",a.type="text/css",a.rel="stylesheet",a.onerror=function(){throw new Error("CRITICAL: Failed to load FH styles.")},t.head.append(a)},ke=function(e){if(e){var i="https:"+d.STATIC_PREFIX+"releases/chatbot/chatbot@LATEST/",a=t.createElement("div");a.id="impel-chatbot",U("body").prepend(a);var n=t.createElement("script"),r=t.createElement("link");U("head").append(r),U("head").append(n),r.href=i+"impel-chatbot-style.css",r.type="text/css",r.rel="stylesheet",n.onload=function(){var e="",t={};d.chatbot_avatar&&(e="prod"===d.static_env?"https://cdn.impel.io/sts-content/provider_script_avatars/":"https://cdn.testenv.impel.io/sts-content-testenv/provider_script_avatars/",e+=d.chatbot_avatar);var i={primaryGradientColor:d.chatbot_primary_gradient_color,secondaryGradientColor:d.chatbot_secondary_gradient_color,location:d.browser.mobile&&d.chatbot_mobile_entry_position?d.chatbot_mobile_entry_position:d.chatbot_entry_position,agentName:d.chatbot_agent_name,avatarURL:e,apiKey:d.chatbot_api_key,pageType:d.page_type?d.page_type:"homepage",isMobile:d.browser.mobile,loadOpened:d.args.chatloadopened,utmSource:d.args.utm_source,utmMedium:d.args.utm_medium,utmCampaign:d.args.utm_campaign,hideNotificationBubbleDesktop:!!d.chatbot_hide_notification_bubble_desktop&&d.chatbot_hide_notification_bubble_desktop,hideNotificationBubbleMobile:!d.chatbot_hide_notification_bubble_mobile||d.chatbot_hide_notification_bubble_mobile,shiftDigitalEnabled:!!d.chatbot_shift_digital_enabled&&d.chatbot_shift_digital_enabled};d.send_asc_formatted_events&&(d.ga4_measurement_id&&(i.ga4MeasurementId=d.ga4_measurement_id),d.tealium_tag_name&&(i.tealiumTagName=d.tealium_tag_name));for(var a in i)i[a]||delete i[a];t=ye(),ImpelChatbot.render(i,t),se=!0},n.src=i+"impel-chatbot.js"}},xe=function(){function i(e,t,i){U.ajax({url:e,dataType:"script",cache:"true",success:function(){i(d[t])}})}function a(){if(!oe){const e=n.max(5,(1*new Date-$)/10);return void s(a,e)}d.iframeless_enabled&&(add_spinviewer_module_helper(),be()),z(function(e){e?N(function(e){e&&ke(e)},d.static_env):ke(d.chatbot_enabled)},d.static_env),g=!0}function r(){g||(d.configureImpelAna(),we(),_(),a())}function o(a,o,l,u){if(d.ga4_measurement_id)try{gtag("get",d.ga4_measurement_id,"session_id",function(e){d.ga4_session_id=e})}catch(e){c.warn("STS.ga4_measurement_id present but no gtag function available")}var _=!1;i(p+a+f,"provider_script",function(i){i(X,function i(a,p,f,h,g){d.page_type="";var v;if(h=h||function(){return 0===e.location.pathname.replace(/\//g,"").length},"function"==typeof a){if(v=U.trim(a()),d.srp_vins=(!ee||"b"!==te.group)&&f&&f(),d.srp_vins){if(d.srp_vins.length<3&&!_)return _=!0,void s(function(){i(a,p,f,h,g)},1e3);d.page_type="srp"}else if(h())d.page_type="homepage";else if(!v){var m=20;return-1===t.readyState.indexOf("in")&&(m=n.max(20,(1*new Date-d.load_start)/10)),m>550&&r(),void(d.retry_timeout=s(function(){i(a,p,f,h,g)},m))}}else v=U.trim(a);if(!d.page_type&&v&&(d.vin=v,d.page_type=d.analytics2.page_type="vdp"),U(e).triggerHandler("page_type"),r(),"vdp"===d.page_type){if("function"==typeof l&&(p=l(p)),"string"==typeof l){try{c.log("Detected vin: "+V(v))}catch(e){}v=l}u(o,v,p,g)}d.Analytics2.provider_script_loaded(o,v.toLowerCase())})})}function l(){function e(e){return"0123456789 ABCDEFGH_ JKLMN_P_R _STUVWXYZ".indexOf(e)%10}var i="";try{i=t.documentElement.innerHTML}catch(e){}for(var a=i.match(/\b[A-HJ-NPR-Z0-9]{17}\b/g),n={},r=0;r<a.length;++r)(function(t){if(17!==t.length)return!1;for(var i="0123456789X",a=0,n=0;n<17;++n)a+=e(t[n])*i.indexOf("8765432X098765432"[n]);return i[a%11]===t[8]})(a[r])&&(n[a[r]]=(n[a[r]]||0)+1);var o=null,s=0,c=0;for(var l in n)n.hasOwnProperty(l)&&(n[l]>s?(s=n[l],o=l):n[l]>c&&(c=n[l]));return s>=5&&2*c<s?o:null}var u=Q+"integrate/"+Z+".js?_="+d.static_content_commit,p=Q+"provider_scripts/",f=".js?_="+d.static_content_commit,h=Q+"guess.js?_="+1*new Date,g=!1;!function(e){var a,n,r=d.args.stsprovider;if(d.args.stsguess)return void U.getScript(h,function(){d.guess(X,function(t){o(t,"swipetospin","tesla",e)})});var c=!1;d.tracking_only&&ve(t.querySelector('iframe[src*=".impel.io"]')),r?o(r,a,void 0,e):i(u,"init",function(t){d.analytics2.missing_script_integration=!1,c=!0;var i=t(X,e);d.old_ui_enabled=d.old_ui_enabled||d.args.enableoldui,d.iframeless_enabled=Boolean((d.iframeless_enabled||d.args.enableiframeless)&&!d.args.disableiframeless),d.iframeless_widescreen_enabled=Boolean((d.iframeless_widescreen_enabled||d.args.enableiframelesswidescreen)&&!d.args.disableiframelesswidescreen),"object"==typeof i&&i.length>=2&&(r=i[0],a=d.customer=d.analytics2.s3_folder=d.args.stscustomer||i[1],d.args.stsregion?d.region=d.args.stsregion:d.regioner(d.customer),n=i[2],o(r,a,n,e))}),s(function(){if(!c){var e=l();d.analytics2.missing_script_integration=!0,d.analytics2.vin=e,d.Analytics2.SendNow()}},6e4)}(M)},Ae=(new Date).getTime(),Se=d.args.teststatic?Ae:n.floor(Ae/6e4);U.ajax({url:Q+"static_content_deployment.js?_="+Se,dataType:"script",cache:!0,success:function(){d.static_content_commit=d.get_static_content_commit(),xe()}}),e.addEventListener("message",R),e.addEventListener("message",B)}}))}(window,document,window.navigator||{},function(){try{localStorage}catch(e){return{}}}(),Math,encodeURIComponent,decodeURIComponent,setTimeout,function(){try{return console}catch(e){return{log:function(){}}}}(),history,STS,XMLHttpRequest);
